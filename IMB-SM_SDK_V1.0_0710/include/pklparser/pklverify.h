/** Copyright (c) 2010 中国数码* All rights reserved.* 文件名称：pklverify.h* 摘    要：PKL验证类，主要提供PKL的签名验证、格式验证等接口。* 当前版本：1.0* 作    者：张量* 取代版本：无* 说明：主要参考CTP_test文档* 完成日期：2010年02月10日*/#ifndef _PKLVERIFY_H#define _PKLVERIFY_H#include "xml/XmlDocument.h"XERCES_CPP_NAMESPACE_USEusing namespace xercesc; class pklVerify{public:	//内部类，主要保存CPL的xml节点对象	class PKLNode	{	public:		PKLNode();		CXmlResultSet* pxmlSignature;		CXmlResultSet* pxmlX509Certificate;		CXmlResultSet* pxmlAnnotationText;		CXmlResultSet* pxmlPKLID;		CXmlResultSet* pxmlAsset;	};	class AssetMapNode	{	public:		AssetMapNode();		CXmlResultSet* pxmlAsset;	};	pklVerify(void);	~pklVerify(void);	/****FUNCTION***************************************************	* DESCRIPTION : PKL验证初始化	*       INPUT : pchPKL PKL字符流	*							：pchAssetMap AssetMap字符流	*      OUTPUT : 无	*     RETURNS : 0成功 非0失败	*    CAUTIONS : 无	****************************************************************/	int PKL_VerifyInitial(const  char* pchPKL,const  char* pchAssetMap);	/****FUNCTION***************************************************	* DESCRIPTION : PKL证书格式验证	*       INPUT : 无	*      OUTPUT : 无	*     RETURNS : 0成功 非0失败	*    CAUTIONS : 无	****************************************************************/	int PKL_CertFormatCheck();		/****FUNCTION***************************************************	* DESCRIPTION :	PKL签名验证	*       INPUT : pchPKL PKL字符流	*             : cert  签名证书	*      OUTPUT : 无	*     RETURNS : 0成功 非0失败	*    CAUTIONS : 无	****************************************************************/	int PKL_SignatureVerify(const char* pchPKL,const char* cert);	/****FUNCTION***************************************************	* DESCRIPTION :	PKL格式验证	*       INPUT : 无	*      OUTPUT : 无	*     RETURNS : 0成功 非0失败	*    CAUTIONS : 无	****************************************************************/	int PKL_FormatCheck();	/****FUNCTION***************************************************	* DESCRIPTION :	判断字符是否是十六进制字符(ACF,aCf,or 0C9)	*       INPUT : 无	*      OUTPUT : 无	*     RETURNS : 0成功 非0失败	*    CAUTIONS : 无	****************************************************************/	static bool is_xdigit(char c);	/****FUNCTION***************************************************	* DESCRIPTION :	判断字符串是否是uuid	*       INPUT : 无	*      OUTPUT : 无	*     RETURNS : 0成功 非0失败	*    CAUTIONS : 无	****************************************************************/	bool is_uuid_string(const char *uuid);	/****FUNCTION***************************************************	* DESCRIPTION : PKL验证	*       INPUT : pchPKL PKL字符流	*							：pchAssetMap AssetMap字符流	*      OUTPUT : 无	*     RETURNS : 0成功 非0失败	*    CAUTIONS : 无	****************************************************************/	int PKL_Verify(const  char* pchPKL,const  char* pchAssetMap);private:	CXmlDocument* m_xmlDocument;//用于解析PKL的xml对象	CXmlDocument* m_xmlAssetMap;//用于解析AssetMap的xml对象	PKLNode* m_pPKLNode;//pkl节点对象	AssetMapNode* m_pAssetMapNode;//assetmap节点对象};#endif